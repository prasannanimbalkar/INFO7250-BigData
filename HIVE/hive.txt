
CREATE TABLE ONLINE_RETAILS(invoice integer, StockCode String, Description String, Quantity Double, InvoiceDate String, Price int, CustomerId int, Country String) COMMENT 'online' ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n' STORED AS TEXTFILE;
LOAD DATA LOCAL INPATH '/Users/prasannanimbalkar/Desktop/MSIS/BigData/FinalProject/Data/onlineRetailMain.csv' OVERWRITE INTO TABLE ONLINE_RETAIL;

SELECT * FROM ONLINE_RETAILS;



-RANGE OF PRICES
SELECT (CASE 
            WHEN Price BETWEEN 0 AND 10 THEN '1_0-10'
            WHEN  Price BETWEEN 10 AND 40 THEN '2_11-40'
            WHEN  Price BETWEEN 40 AND 90 THEN '3_41-90'
            WHEN  Price BETWEEN 90 AND 120 THEN '4_91-120'
            WHEN  Price BETWEEN 120 AND 180 THEN '5_121-180'
            WHEN  Price BETWEEN 180 AND 365 THEN '6_181-365'
            WHEN  Price > 365 THEN '7_365+'
        END) as PriceRange,
       COUNT(*)
FROM ONLINE_RETAILS
GROUP BY (CASE 
            WHEN Price BETWEEN 0 AND 10 THEN '1_0-10'
            WHEN  Price BETWEEN 10 AND 40 THEN '2_11-40'
            WHEN  Price BETWEEN 40 AND 90 THEN '3_41-90'
            WHEN  Price BETWEEN 90 AND 120 THEN '4_91-120'
            WHEN  Price BETWEEN 120 AND 180 THEN '5_121-180'
            WHEN  Price BETWEEN 180 AND 365 THEN '6_181-365'
            WHEN  Price > 365 THEN '7_365+'
          END)
ORDER BY PriceRange;



-MAX QUANTITY
SELECT price_range.*
FROM ONLINE_RETAILS price_range JOIN
     (SELECT max(Price) AS max_quantity
      From ONLINE_RETAILS
     ) price_range_max
     on price_range_max.max_quantity = price_range.Price;




-
Select * from ONLINE_RETAIL3 sort by Price desc limit 10;

Select * from ONLINE_RETAIL3 where Quantity >= 1 sort by Price desc limit 10;

     


